<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>MotoLog - Add Ride</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <style>
    .tags-container { padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; }
    .tag-section { margin-bottom: 1.8rem; }
    .tag-section-title { font-size: 0.95rem; font-weight: 700; color: var(--primary-600); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.9rem; }
    .tags-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1rem; margin-bottom: 0; }
    .tag-checkbox { display: none; }
    .tag-label { display: flex; align-items: center; justify-content: center; padding: 12px 15px; border-radius: 8px; cursor: pointer; font-weight: 700; transition: all 0.18s ease; border: 1px solid color-mix(in srgb, var(--muted) 8%, transparent); background: transparent; color: var(--text); }
    .tag-label:hover { transform: translateY(-3px); box-shadow: var(--shadow-1); }
    .tag-checkbox:checked + .tag-label { background: linear-gradient(135deg, var(--primary-500), var(--primary-600)); color: white; box-shadow: 0 8px 28px rgba(86,118,240,0.12); border-color: transparent; }
    .custom-tags-input { width: 100%; padding: 12px 14px; border-radius: 10px; border: 1px solid color-mix(in srgb, var(--muted) 10%, transparent); background: transparent; color: var(--text); font-family: inherit; }
    .custom-tags-input:focus { outline: none; border-color: var(--primary-500); box-shadow: 0 8px 30px rgba(86,118,240,0.08); }
    .tags-note { color: var(--muted); font-size: 0.92rem; margin-top: 0.5rem; }
    .form-card { padding: 18px; border-radius: 12px; }
  </style>
</head>
<body>
  <div class="dashboard-container">
    {% include '_navbar.html' %}

    <div class="form-card">
      <h2>ğŸï¸ Log Your Ride</h2>

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-messages">
            {% for category, message in messages %}
              <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <form method="POST" action="/add-ride">
        <div class="form-group">
          <label for="date">Date</label>
          <input type="date" id="date" name="date" required>
        </div>

        <div class="form-group">
          <label for="bike_id">Bike (Optional)</label>
          <select id="bike_id" name="bike_id">
            <option value="">-- Select your bike --</option>
            {% for b in bikes %}
              <option value="{{ b['id'] }}">{{ b['name'] }} {% if b['make_model'] %}({{ b['make_model'] }}){% endif %}</option>
            {% endfor %}
          </select>
        </div>

        <div class="form-group">
          <label for="distance">Distance (km)</label>
          <input type="number" id="distance" name="distance" step="0.1" placeholder="50" required>
        </div>

        <div class="form-group">
          <label for="time">Time (hours)</label>
          <input type="number" id="time" name="time" step="0.1" placeholder="2.5" required>
        </div>

        <!-- Tags organized into 3 categories -->
        <div class="tags-container">
          <label style="font-weight: 700; display: block; margin-bottom: 1rem; font-size: 1rem;">ğŸ·ï¸ Ride Tags</label>

          <!-- Weather Category -->
          <div class="tag-section">
            <div class="tag-section-title">â˜€ï¸ Weather</div>
            <div class="tags-grid">
              <div><input type="checkbox" id="tag_sunny" class="tag-checkbox" name="tag" value="sunny"><label for="tag_sunny" class="tag-label">â˜€ï¸ Sunny</label></div>
              <div><input type="checkbox" id="tag_rain" class="tag-checkbox" name="tag" value="rain"><label for="tag_rain" class="tag-label">ğŸŒ§ï¸ Rain</label></div>
              <div><input type="checkbox" id="tag_cloudy" class="tag-checkbox" name="tag" value="cloudy"><label for="tag_cloudy" class="tag-label">â˜ï¸ Cloudy</label></div>
              <div><input type="checkbox" id="tag_cold" class="tag-checkbox" name="tag" value="cold"><label for="tag_cold" class="tag-label">â„ï¸ Cold</label></div>
            </div>
          </div>

          <!-- Terrain Category -->
          <div class="tag-section">
            <div class="tag-section-title">ğŸ›£ï¸ Terrain</div>
            <div class="tags-grid">
              <div><input type="checkbox" id="tag_gravel" class="tag-checkbox" name="tag" value="gravel"><label for="tag_gravel" class="tag-label">ğŸª¨ Gravel</label></div>
              <div><input type="checkbox" id="tag_offroad" class="tag-checkbox" name="tag" value="offroad"><label for="tag_offroad" class="tag-label">ğŸœï¸ Offroad</label></div>
              <div><input type="checkbox" id="tag_highway" class="tag-checkbox" name="tag" value="highway"><label for="tag_highway" class="tag-label">ğŸ›£ï¸ Highway</label></div>
              <div><input type="checkbox" id="tag_city" class="tag-checkbox" name="tag" value="city"><label for="tag_city" class="tag-label">ğŸ™ï¸ City</label></div>
            </div>
          </div>

          <!-- Style/Purpose Category -->
          <div class="tag-section">
            <div class="tag-section-title">ğŸ¯ Style & Purpose</div>
            <div class="tags-grid">
              <div><input type="checkbox" id="tag_commute" class="tag-checkbox" name="tag" value="commute"><label for="tag_commute" class="tag-label">ğŸš— Commute</label></div>
              <div><input type="checkbox" id="tag_tour" class="tag-checkbox" name="tag" value="tour"><label for="tag_tour" class="tag-label">ğŸ—ºï¸ Tour</label></div>
              <div><input type="checkbox" id="tag_sport" class="tag-checkbox" name="tag" value="sport"><label for="tag_sport" class="tag-label">âš¡ Sport</label></div>
              <div><input type="checkbox" id="tag_leisure" class="tag-checkbox" name="tag" value="leisure"><label for="tag_leisure" class="tag-label">ğŸ˜ Leisure</label></div>
            </div>
          </div>

          <!-- Custom Tags -->
          <div style="margin-top: 1.8rem;">
            <label for="custom_tags" style="display: block; margin-bottom: 0.5rem; font-weight: 700; color: var(--primary-600); text-transform: uppercase; font-size: 0.95rem;">+ Add Custom Tags</label>
            <input type="text" id="custom_tags" name="custom_tags" class="custom-tags-input" placeholder="Add custom tags separated by commas">
            <div class="tags-note">ğŸ’¡ Separate multiple custom tags with commas</div>
          </div>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" name="description" rows="3" placeholder="Short notes about your ride..."></textarea>
        </div>

        <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem;">
            <input type="checkbox" id="is_private" name="is_private">
            <span style="font-weight: 700;">Mark ride as private</span>
          </label>
          <div style="color: var(--muted); font-size: 0.9rem; margin-top: 0.5rem;">Private rides are visible only to you.</div>
        </div>

        <div class="form-group">
          <button type="submit" style="background: linear-gradient(135deg, var(--primary-500), var(--primary-600)); color: white; padding: 1rem 2rem; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem; width: 100%; transition: all 0.2s; margin-top: 1rem;">âœ… Save Ride</button>
        </div>

        <p style="text-align: center; margin-top: 0.5rem;">
          <a href="/dashboard" style="color: var(--primary-600); text-decoration: none;">â† Back to Dashboard</a>
        </p>
      </form>
    </div>
  </div>
</body>
</html>